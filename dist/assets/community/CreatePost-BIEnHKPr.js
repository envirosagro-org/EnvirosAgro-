import{c5 as C,c6 as P,c7 as S,c8 as I,c9 as z,ca as L,r,j as e,L as p,X as A,cb as R,I as U,cc as D,cd as E,ce as F,cf as T,cg as $,ch as B,ci as q}from"../vendor-paJ_2uBt.js";const G={apiKey:"AIzaSyBNVYoqxPepnbRRtC68BRTxgqFp1FVO3xI",authDomain:"envirosagro-git-93534258-78537.firebaseapp.com",projectId:"envirosagro-git-93534258-78537",storageBucket:"envirosagro-git-93534258-78537.firebasestorage.app",messagingSenderId:"399076515746",appId:"1:399076515746:web:f947e5e4dd216826b81cfb",measurementId:"G-1MNDXE8PG5"},c=C(G);typeof window<"u"?P().then(t=>t?S(c):null):Promise.resolve(null);const K=I(c),V=z(c),W=L(c),M=({user:t,onClose:h,onPostCreated:f})=>{const[d,b]=r.useState(""),[n,j]=r.useState(null),[o,l]=r.useState("text"),[u,k]=r.useState(""),[x,g]=r.useState(!1),[m,i]=r.useState(null),v=a=>{if(a.target.files&&a.target.files[0]){const s=a.target.files[0];j(s),s.type.startsWith("image/")?l("image"):l("text")}},w=async a=>{if(a.preventDefault(),!t){i("User not found. Please log in again.");return}if(!d.trim()){i("Post content cannot be empty.");return}g(!0),i(null);try{let s="";if(n){const y=E(W,`posts/${t.email}/${Date.now()}_${n.name}`),N=await F(y,n);s=await T(N.ref)}await $(B(V,"posts"),{authorName:t.name,authorEmail:t.email,authorAvatar:t.avatar||null,text:d,type:o,attachmentUrl:s,linkUrl:o==="link"?u:"",timestamp:q(),likes:0,comments:[]}),f(),h()}catch(s){i("Failed to create post. Please try again."),console.error(s)}finally{g(!1)}};return t?e.jsxs("div",{className:"bg-white dark:bg-earth-900 rounded-3xl shadow-2xl w-full max-w-2xl p-8 relative",children:[e.jsx("button",{onClick:h,className:"absolute top-6 right-6 text-earth-400 hover:text-red-500 transition-colors",children:e.jsx(A,{size:24})}),e.jsx("h2",{className:"text-2xl font-bold text-agro-900 dark:text-white mb-6",children:"Create a New Post"}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsx("textarea",{value:d,onChange:a=>b(a.target.value),placeholder:`What's on your mind, ${t.name}?`,className:"w-full h-32 bg-earth-50 dark:bg-earth-800 rounded-xl p-4 focus:outline-none focus:ring-2 focus:ring-agro-500 dark:text-white transition",required:!0}),o==="link"&&e.jsx("input",{type:"url",value:u,onChange:a=>k(a.target.value),placeholder:"Enter URL...",className:"w-full bg-earth-100 dark:bg-earth-800 rounded-xl p-3 px-4 focus:outline-none focus:ring-2 focus:ring-agro-500 dark:text-white"}),n&&e.jsxs("div",{className:"text-sm text-earth-500 dark:text-earth-400",children:["Attached: ",n.name]}),m&&e.jsx("p",{className:"text-red-500 text-sm",children:m}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer p-3 rounded-full hover:bg-earth-100 dark:hover:bg-earth-800 text-earth-500 dark:text-earth-400 transition-colors",children:[e.jsx(R,{size:20}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:v})]}),e.jsx("button",{type:"button",onClick:()=>l("image"),className:`p-3 rounded-full hover:bg-earth-100 dark:hover:bg-earth-800 ${o==="image"?"text-agro-600":"text-earth-500 dark:text-earth-400"}`,children:e.jsx(U,{size:20})}),e.jsx("button",{type:"button",onClick:()=>l("link"),className:`p-3 rounded-full hover:bg-earth-100 dark:hover:bg-earth-800 ${o==="link"?"text-agro-600":"text-earth-500 dark:text-earth-400"}`,children:e.jsx(D,{size:20})})]}),e.jsx("button",{type:"submit",disabled:x,className:"bg-agro-600 hover:bg-agro-700 text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center justify-center gap-2 transition-all disabled:bg-earth-300",children:x?e.jsx(p,{className:"animate-spin",size:20}):"Post"})]})]})]}):e.jsx("div",{className:"bg-white dark:bg-earth-900 rounded-3xl shadow-2xl w-full max-w-2xl p-8 relative flex items-center justify-center h-96",children:e.jsx(p,{className:"animate-spin text-agro-500",size:48})})};export{M as C,K as a,V as d};
